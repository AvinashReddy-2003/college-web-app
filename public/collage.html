<!DOCTYPE html>
<html>

<head>
    <meta charset="utf-8" />
    <meta content="html,css,javascript" name="keywords" />
    <meta ,initial-scale='1.0"' content="width=device-width, initial-scale=1.0" name="viewport" />
    <title>bec.co.in</title>
    <link href="icon" type="image/x-icon"
        href="https://www.google.com/imgres?q=bapatla%20engineering%20college%20logo&imgurl=https%3A%2F%2Flookaside.fbsbx.com%2Flookaside%2Fcrawler%2Fmedia%2F%3Fmedia_id%3D100063863182337&imgrefurl=https%3A%2F%2Fwww.facebook.com%2Fbecbapatlaofficial%2F&docid=a35UpXZqksLacM&tbnid=jItWhKWExny49M&vet=2ahUKEwiKreWwxdqNAxU7ZfUHHZxtIbwQM3oECGUQAA..i&w=382&h=382&hcb=2&ved=2ahUKEwiKreWwxdqNAxU7ZfUHHZxtIbwQM3oECGUQAA" />
    <link href="index1.css" rel="stylesheet">
    <script src="chatgpt.js"></script>
    <style>
        body {
            background-color: black;
        }

        ul {
            margin: 0px;
            padding: 0px;
            overflow: hidden;
            background-color: #1e1d1d;
        }

        li a {
            float: right;
        }

        img {
            float: left;
            display: block;
            padding: 2px;
        }

        li a {
            display: block;
            color: rgb(153, 33, 33);
            padding: 20px;
        }

        li a:hover {
            background-color: purple;
            /* Changed background color on hover */
            color: yellow;
            /* Changed text color on hover */
        }

        h1 {
            color: white;
            text-align: center;
        }

        p {
            color: white;
            text-align: center;
        }

        div.myclass1 {
            width: 100%;
        }

        div.myclass1 div {
            width: 33%;
            display: inline-block;
            border: 1px solid rgb(159, 96, 41);
        }

        div.myclass2 {
            width: 100%;
        }

        div.myclass2 div {
            width: 33%;
            display: inline-block;
            border: 1px solid rgb(159, 96, 41);
        }

        .loginform {
            background-color: rgb(90, 62, 86);
            color: white;
            width: 230px;
            /* Original width */
            /* Removed fixed height to allow content to expand */
            position: absolute;
            border: 1px solid white;
            border-left-width: 2px;
            left: 400px;
            padding-left: 3px;
            border-left-width: 3px;
            margin-left: 150px;
            margin-top: 30px;
            padding-bottom: 20px;
            /* Adjusted padding-bottom */
        }

        /* Added new style for button container */
        .button-container {
            display: flex;
            justify-content: center;
            /* Center buttons horizontally */
            align-items: center;
            /* Align buttons vertically */
            gap: 10px;
            /* Space between buttons */
            margin-top: 20px;
            /* Maintain similar top margin as before */
        }

        .loginform2 {
            background-color: rgb(252, 83, 246);
            color: white;
            width: 230px;
            height: 250px;
            position: absolute;
            border: 2px solid white;
            margin-top: 30px;
            margin-left: 50%;
        }

        .describe {
            text-align: center;
            color: blueviolet;
            background-color: antiquewhite;
        }

        @media (max-width: 768px) {
            ul {
                flex-direction: column;
                align-items: flex-start;
            }

            li a {
                float: none;
                padding: 10px;
            }

            div.myclass1 div,
            div.myclass2 div {
                width: 100%;
                display: block;
            }

            .loginform,
            .loginform2 {
                position: relative;
                margin: 10px auto;
                left: 0;
                right: 0;
            }

            img {
                float: none;
                display: block;
                margin: 0 auto;
            }
        }

        @media (max-width: 480px) {

            h1,
            p {
                font-size: 16px;
            }

            button,
            input {
                font-size: 14px;
            }
        }
    </style>
    </link>
</head>

<body>
    <nav>
        <ul id="mylist" type="none">
            <li><a href="#HOME">HOME</a></li>
            <li><a href="#CONTACT">CONTACT</a></li>
            <li><a href="#ABOUT">ABOUT</a></li>
            <li><a href="#name">DETAILS</a></li>
            <li><img src="https://encrypted-tbn0.gstatic.com/images?q=tbn:ANd9GcRi94Xv3s28hSeT2Byljkrp3snR_T2ELucoQA&s"
                    alt="cannot open" width="50px" height="50px" style="padding-top: 6px;padding-left:7px;">
            </li>
        </ul>
    </nav>
    <div class="myclass">
        <img alt="cannot open" height="200px"
            src="https://encrypted-tbn0.gstatic.com/images?q=tbn:ANd9GcTPCxnckVaHvL32jC2GudQeuuNCJfIRw5mzPA&s"
            width="100%" />
    </div>
    <h1>Bapatla Engineering Collage</h1>
    <p>Bapatla Engineering College is a private engineering college and is one of the seven educational
        institutions<br />
        sponsored by the Bapatla Education Society. BEC was established in 1981. The founder president for this
        institute is Yarlagadda Krishna Murthy. It is located in Bapatla district.
    </p>
    <br />
    <div class="myclass1">
        <div style="background-color:blueviolet">
            <h1>Computer Science</h1>
            <p>Computer science is the study of computers and how they are used, including the theory and practice of
                computing. It's a broad field that uses engineering, logic, and mathematics to solve problems</p>
        </div>
        <div style="background-color:rgb(90, 70, 133)">
            <h1>Electronic Communication</h1>
            <p>Electronic communication is the transmission of information using electronic devices and technologies. It
                can be done via email, video calling, fax, and more. Electronic communication is a quick.</p>
        </div>
        <div style="background-color:rgb(105, 155, 125)">
            <h1>Information Technology</h1>
            <p>Information technology (IT) is the use of computers, software, networks, and other devices to store,
                retrieve, and share information. It's a broad field that includes many subfields and specializations.
            </p>
        </div>
    </div>
    <br />
    <div class="myclass2">
        <div style="background-color:blueviolet">
            <h1>Civil Engineering</h1>
            <p>Civil engineering is a broad discipline focused on designing, constructing, and maintaining
                the physical and naturally built environment,works like roads, bridges, buildings, and infrastructure.
            </p>
        </div>
        <div style="background-color:rgb(90, 70, 133)">
            <h1>Mechanical Engineering</h1>
            <p>Mechanical engineering is a broad engineering discipline focused on designing, analyzing, manufacturing,
                and maintaining mechanical systems, encompassing the study of physical machines.</p>
        </div>
        <div style="background-color:rgb(105, 155, 125)">
            <h1>Elctrical Electronics</h1>
            <p>Electrical and Electronics Engineering (EEE) is a broad field that focuses on the study and application
                of electricity,electronics, and electromagnetism, encompassing areas like power systems.
            </p>
        </div>
    </div>
    <div class="loginform">
        <br />
        <!-- Action changed to /login for the form -->
        <form action="/login" method="POST" id="registrationForm">
            <h1 class="login" style="color:rgb(62, 18, 163)">Student login</h1>
            <div id="initialLoginFields">
                <label for="username">Registration no:</label><br />
                <input id="username" name="username" placeholder="Enter registration number" required=""
                    style="border-radius:5px; width: calc(100% - 10px); padding: 5px; box-sizing: border-box;"
                    type="text" /><br />
                <label for="password">Password:</label><br />
                <input id="password" name="password" placeholder="Enter password" required=""
                    style="border-radius:5px; width: calc(100% - 10px); padding: 5px; box-sizing: border-box;"
                    type="password" /><br />
            </div>

            <!-- Button container for Login and Register -->
            <div class="button-container">
                <button type="submit" id="loginButton"
                    style="padding: 8px 15px; border-radius: 5px; background-color: rgb(85, 180, 155); color: white; border: none; cursor: pointer;">Login</button>
                <button type="button" id="registerButton"
                    style="padding: 8px 15px; border-radius: 5px; background-color: rgb(62, 18, 163); color: white; border: none; cursor: pointer;">Register</button>
            </div>

            <!-- OTP Registration Section (Initially hidden) -->
            <div id="otpRegistrationSection" style="display: none; text-align: center; margin-top: 15px;">
                <label for="emailInput" style="color: white; display: block; margin-bottom: 5px;">Email:</label>
                <input type="email" id="emailInput" name="email" placeholder="Enter your email"
                    style="border-radius:5px; width: calc(100% - 20px); padding: 8px; box-sizing: border-box;" /><br />
                <button type="button" id="sendOtpButton"
                    style="margin-top: 15px; padding: 8px 15px; border-radius: 5px; background-color: rgb(85, 180, 155); color: white; border: none; cursor: pointer;">Send
                    OTP</button>
                <p id="otpMessage" style="color: yellow; margin-top: 10px; font-size: 0.9em;"></p>

                <!-- OTP Verification fields (initially hidden) -->
                <div id="otpVerificationFields" style="display: none; margin-top: 15px;">
                    <label for="otpInput" style="color: white;">Enter OTP:</label><br />
                    <input type="text" id="otpInput" name="otpInput" placeholder="Enter OTP"
                        style="border-radius:5px; width: calc(100% - 20px); padding: 8px; box-sizing: border-box;" /><br />
                    <button type="button" id="verifyOtpButton"
                        style="margin-top: 10px; padding: 8px 15px; border-radius: 5px; background-color: orange; color: white; border: none; cursor: pointer;">Verify
                        OTP</button>
                </div>
                <!-- Final registration fields (initially hidden) -->
                <div id="finalRegistrationFields" style="display: none; margin-top: 15px;">
                    <label for="regUsername" style="color: white;">Registration Number:</label><br />
                    <input type="text" id="regUsername" name="regUsername" placeholder="Enter registration number"
                        style="border-radius:5px; width: calc(100% - 20px); padding: 8px; box-sizing: border-box;" /><br />
                    <label for="regPassword" style="color: white; margin-top: 10px;">Password:</label><br />
                    <input type="password" id="regPassword" name="regPassword" placeholder="Create a password"
                        style="border-radius:5px; width: calc(100% - 20px); padding: 8px; box-sizing: border-box;" /><br />
                    <button type="button" id="finalRegisterButton"
                        style="margin-top: 15px; padding: 8px 15px; border-radius: 5px; background-color: green; color: white; border: none; cursor: pointer;">Finish
                        Registration</button>
                </div>
            </div>

        </form>
    </div>
    <br />
    <br />
    <br />
    <hr style="margin-top:300px" />
    <script>
        document.addEventListener('DOMContentLoaded', function () {
            // Get references to all relevant DOM elements
            const initialLoginFields = document.getElementById('initialLoginFields');
            const loginButton = document.getElementById('loginButton');
            const registerButton = document.getElementById('registerButton');
            const otpRegistrationSection = document.getElementById('otpRegistrationSection');
            const emailInput = document.getElementById('emailInput');
            const sendOtpButton = document.getElementById('sendOtpButton');
            const otpMessage = document.getElementById('otpMessage');
            const otpVerificationFields = document.getElementById('otpVerificationFields');
            const otpInput = document.getElementById('otpInput');
            const verifyOtpButton = document.getElementById('verifyOtpButton');
            const loginFormTitle = document.querySelector('.loginform .login');
            const registrationForm = document.getElementById('registrationForm'); // Get the form element

            // No longer storing generatedOtp client-side; it's handled by server.

            /**
             * Resets the form back to its initial state, showing the username/password fields
             * and the Login/Register buttons. Clears messages and input.
             */
            function resetFormToInitialState() {
                initialLoginFields.style.display = 'block'; // Show username/password
                loginButton.style.display = 'inline-block';
                registerButton.style.display = 'inline-block';
                otpRegistrationSection.style.display = 'none'; // Hide OTP section
                otpVerificationFields.style.display = 'none'; // Hide OTP verification fields
                otpMessage.textContent = ''; // Clear any messages
                emailInput.value = ''; // Clear email input
                otpInput.value = ''; // Clear OTP input
                sendOtpButton.disabled = false; // Enable OTP button
                loginFormTitle.textContent = 'Student login'; // Reset title to original
                // Ensure the form action is set correctly for login when resetting
                registrationForm.action = '/login';
            }

            /**
             * Handles the click event for the Register button.
             * It hides the initial login fields and shows the email input for OTP registration.
             */
            registerButton.onclick = function () {
                initialLoginFields.style.display = 'none'; // Hide username/password fields
                loginButton.style.display = 'none'; // Hide login button
                registerButton.style.display = 'none'; // Hide register button
                otpRegistrationSection.style.display = 'block'; // Show the OTP registration section
                otpMessage.textContent = ''; // Clear any previous messages
                emailInput.value = ''; // Clear email input field
                otpInput.value = ''; // Clear OTP input field
                otpVerificationFields.style.display = 'none'; // Ensure OTP verification is hidden
                loginFormTitle.textContent = 'Register'; // Change form title
                // Form action remains /login, but OTP flow uses fetch API
            };

            /**
             * Handles the click event for the Send OTP button.
             * Validates the email, makes an API call to the server to send OTP,
             * and displays success or error messages.
             */
            sendOtpButton.onclick = async function () { // Made async
                const email = emailInput.value;

                // Basic email validation
                if (!email || !email.includes('@') || !email.includes('.')) {
                    otpMessage.textContent = 'Please enter a valid email address.';
                    otpMessage.style.color = 'red';
                    return;
                }

                otpMessage.textContent = 'Sending OTP to ' + email + '...';
                otpMessage.style.color = 'yellow';
                sendOtpButton.disabled = true;

                try {
                    const response = await fetch('/send-otp', {
                        method: 'POST',
                        headers: {
                            'Content-Type': 'application/json',
                        },
                        body: JSON.stringify({ email: email }),
                    });

                    const data = await response.json();

                    if (response.ok) {
                        otpMessage.textContent = 'OTP sent! Please check your email.';
                        otpMessage.style.color = 'lightgreen';
                        otpVerificationFields.style.display = 'block'; // Show OTP verification fields
                        sendOtpButton.style.display = 'none'; // Hide Send OTP button
                    } else {
                        // Display error message from server or a generic one
                        otpMessage.textContent = 'Failed to send OTP: ' + (data.error || 'Unknown error');
                        otpMessage.style.color = 'red';
                        sendOtpButton.disabled = false; // Re-enable if sending failed
                    }
                } catch (error) {
                    console.error('Error sending OTP:', error);
                    otpMessage.textContent = 'Network error. Please try again.';
                    otpMessage.style.color = 'red';
                    sendOtpButton.disabled = false; // Re-enable on network error
                }
            };

            /**
             * Handles the click event for the Verify OTP button.
             * Makes an API call to the server to verify OTP and displays the result.
             */
            verifyOtpButton.onclick = async function () { // Made async
                const email = emailInput.value; // The email used to request the OTP
                const enteredOtp = otpInput.value;

                if (!enteredOtp) {
                    otpMessage.textContent = 'Please enter the OTP.';
                    otpMessage.style.color = 'red';
                    return;
                }

                otpMessage.textContent = 'Verifying OTP...';
                otpMessage.style.color = 'yellow';
                verifyOtpButton.disabled = true; // Disable to prevent multiple clicks

                try {
                    const response = await fetch('/verify-otp', {
                        method: 'POST',
                        headers: {
                            'Content-Type': 'application/json',
                        },
                        body: JSON.stringify({ email: email, otp: enteredOtp }), // Send email along with OTP
                    });

                    const data = await response.json();

                    if (response.ok && data.success) {
                        otpMessage.textContent = 'OTP verified! Now complete registration.';
                        otpMessage.style.color = 'lightgreen';
                        otpVerificationFields.style.display = 'none';
                        document.getElementById('finalRegistrationFields').style.display = 'block';
                    } else {
                        otpMessage.textContent = 'Invalid OTP. Please try again.';
                        otpMessage.style.color = 'red';
                        otpInput.value = ''; // Clear OTP input for retry
                        verifyOtpButton.disabled = false; // Re-enable button on failure
                    }
                } catch (error) {
                    console.error('Error verifying OTP:', error);
                    otpMessage.textContent = 'Network error during OTP verification. Please try again.';
                    otpMessage.style.color = 'red';
                    verifyOtpButton.disabled = false; // Re-enable on network error
                }
            };

            /**
             * Handles the click event for the Login button.
             * Now submits the form to the dashboard page via server.
             */
            loginButton.onclick = function () {
                registrationForm.submit(); // Submit the form to the /login endpoint
            };
        });
        document.getElementById('finalRegisterButton').onclick = async function () {
            const email = document.getElementById('emailInput').value;
            const username = document.getElementById('regUsername').value;
            const password = document.getElementById('regPassword').value;

            if (!username || !password) {
                alert("Please fill in registration number and password.");
                return;
            }

            try {
                const response = await fetch('/register', {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json',
                    },
                    body: JSON.stringify({ username, password, email }),
                });

                const data = await response.json();
                if (response.ok) {
                    alert(data.message || "Registration complete! Please login.");
                    location.reload(); // Reset to login form
                } else {
                    alert(data.error || "Registration failed.");
                }
            } catch (err) {
                alert("Server error during registration.");
            }
        };
    </script>
    <footer>
        <div class="describe">
            <h1 style="color:rgb(85, 180, 155)">Bapatla Engineering Collage(Autonomous)</h1>
            <h3><a alt="cannot open" href="www.becbapatla.ac.in">www.becbapatla.ac.in</a></h3>
            <h4 style="color:rgb(110, 100, 67)">Developed by Avinash Reddy </h4>
            <h5>Department Data Science</h5>
        </div>
    </footer>
</body>

</html>